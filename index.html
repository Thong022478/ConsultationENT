<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultation Record</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
    </style>
</head>
<body class="min-h-screen" style="background-image: url('https://png.pngtree.com/background/20230525/original/pngtree-image-of-futuristic-medical-hospital-room-picture-image_2736851.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed;">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-2">Consultation Record</h1>
            <p class="text-red-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>
        </div>

        <!-- Form Container -->
        <div class="max-w-2xl mx-auto bg-white rounded-xl shadow-lg border-2 border-purple-100 p-8">
            <form id="patientForm" class="space-y-6">
                <!-- HN -->
                <div>
                    <label for="hn" class="block text-sm font-medium text-purple-700 mb-2">
                        üè• HN (‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢) <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="hn" name="hn" required
                           class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30"
                         >
                </div>

                <!-- ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• -->
                <div>
                    <label for="fullname" class="block text-sm font-medium text-purple-700 mb-2">
                        üë§ ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="fullname" name="fullname" required
                           class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30"
                    >
                </div>

                <!-- ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î -->
                <!-- ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î -->
                <div>
                    <label for="birthdate" class="block text-sm font-medium text-purple-700 mb-2">
                        üéÇ ‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ ‡πÄ‡∏Å‡∏¥‡∏î (‡∏û.‡∏®.) <span class="text-red-500">*</span>
                    </label>
                    <div class="flex gap-2">
                        <select id="birthDay" name="birthDay" required
                                class="flex-1 px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30">
                            <option value="">‡∏ß‡∏±‡∏ô</option>
                        </select>
                        <select id="birthMonth" name="birthMonth" required
                                class="flex-1 px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30">
                            <option value="">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                            <option value="1">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                            <option value="2">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                            <option value="3">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
                            <option value="4">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
                            <option value="5">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
                            <option value="6">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
                            <option value="7">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
                            <option value="8">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
                            <option value="9">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
                            <option value="10">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
                            <option value="11">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
                            <option value="12">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                        </select>
                        <select id="birthYear" name="birthYear" required
                                class="flex-1 px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30">
                            <option value="">‡∏õ‡∏µ ‡∏û.‡∏®.</option>
                        </select>
                    </div>
                </div>

		<!-- ‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥) -->
                <div>
                    <label for="age" class="block text-sm font-medium text-purple-700 mb-2">
                        üéØ ‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
                    </label>
                    <input type="text" id="age" name="age" readonly
                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg bg-gray-50 text-gray-700 cursor-not-allowed"
                           placeholder="‡∏≠‡∏≤‡∏¢‡∏∏‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î">
                </div>

                <!-- ‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏ß‡∏£ consult -->
                <div>
                    <label for="doctor" class="block text-sm font-medium text-purple-700 mb-2">
                        üë®‚Äç‚öïÔ∏è ‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏ß‡∏£ consult <span class="text-red-500">*</span>
                    </label>
                    <select id="doctor" name="doctor" required
                            class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏ß‡∏£</option>
                        <option value="‡∏û‡∏ç.‡∏™‡∏•‡∏¥‡∏•‡∏ß‡∏µ  ‡∏®‡∏¥‡∏£‡∏∞‡∏ß‡∏¥‡∏®‡∏¥‡∏©‡∏è‡πå‡∏û‡∏£">‡∏û‡∏ç.‡∏™‡∏•‡∏¥‡∏•‡∏ß‡∏µ ‡∏®‡∏¥‡∏£‡∏∞‡∏ß‡∏¥‡∏®‡∏¥‡∏©‡∏è‡πå‡∏û‡∏£</option>
                        <option value="‡∏û‡∏ç.‡∏ß‡∏¥‡∏£‡∏¥‡∏¢‡∏≤  ‡πÅ‡∏™‡∏á‡πÄ‡∏à‡∏£‡∏¥‡∏ç">‡∏û‡∏ç.‡∏ß‡∏¥‡∏£‡∏¥‡∏¢‡∏≤  ‡πÅ‡∏™‡∏á‡πÄ‡∏à‡∏£‡∏¥‡∏ç</option>
                        <option value="‡∏û‡∏ç.‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå  ‡∏Ñ‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå">‡∏û‡∏ç.‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå  ‡∏Ñ‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</option>
                        <option value="‡∏û‡∏ç.‡∏û‡∏±‡∏ä‡∏£‡∏ò‡∏£‡∏ì‡πå  ‡∏≠‡∏†‡∏¥‡∏£‡∏±‡∏Å‡∏©‡πå‡∏ä‡∏π‡∏û‡∏¥‡∏°‡∏•">‡∏û‡∏ç.‡∏û‡∏±‡∏ä‡∏£‡∏ò‡∏£‡∏ì‡πå  ‡∏≠‡∏†‡∏¥‡∏£‡∏±‡∏Å‡∏©‡πå‡∏ä‡∏π‡∏û‡∏¥‡∏°‡∏•</option>
                        <option value="‡∏û‡∏ç.‡∏ê‡∏¥‡∏ï‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå  ‡∏ï‡∏±‡∏ô‡∏°‡∏á‡∏Ñ‡∏•‡∏Å‡∏≤‡∏ç‡∏à‡∏ô">‡∏û‡∏ç.‡∏ê‡∏¥‡∏ï‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå  ‡∏ï‡∏±‡∏ô‡∏°‡∏á‡∏Ñ‡∏•‡∏Å‡∏≤‡∏ç‡∏à‡∏ô</option>
                    </select>
                </div>

                <!-- Diagnosis -->
                <div>
                    <label for="diagnosis" class="block text-sm font-medium text-purple-700 mb-2">
                        Diagnosis <span class="text-red-500">*</span>
                    </label>
                    <textarea id="diagnosis" name="diagnosis" required rows="3"
                              class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30"></textarea>
                </div>

                <!-- Consult for -->
                <div>
                    <label for="consultFor" class="block text-sm font-medium text-purple-700 mb-2">
                        Consult for <span class="text-red-500">*</span>
                    </label>
                    <textarea id="consultFor" name="consultFor" required rows="3"
                              class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30"
                              placeholder="‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ consult"></textarea>
                </div>

                <!-- Ward -->
                <div>
                    <label for="ward" class="block text-sm font-medium text-purple-700 mb-2">
                        Ward <span class="text-red-500">*</span>
                    </label>
                    <select id="ward" name="ward" required
                            class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-400 transition duration-200 bg-purple-50/30">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</option>
                        <option value="Ward ICU 4C">Ward ICU 4C</option>
                        <option value="Ward CCU 4D2">Ward CCU 4D2</option>
                        <option value="Ward CCU 4D3">Ward SICU 4D2</option>
                        <option value="Ward 5C">Ward 5C</option>
                        <option value="Ward 5D">Ward 5D</option>
                        <option value="Ward 5E">Ward 5E</option>
                        <option value="Ward 6B1">Ward 6B1</option>
                        <option value="Ward 6B2">Ward 6B2</option>
                        <option value="Ward 6C">Ward 6C</option>
                        <option value="Ward 6E">Ward 6E</option>
                        <option value="Ward 6F">Ward 6F</option>
                        <option value="Ward 7F">Ward 7F</option>
                    </select>
                </div>

                <!-- Submit Button -->
                <div class="pt-4 flex justify-center">
                    <button type="submit" 
                            class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold text-lg py-4 px-12 rounded-lg transition duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 shadow-lg flex items-center gap-3">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <!-- Paper airplane body -->
                            <path d="M12 2L4 20L12 16L20 20L12 2Z" fill="white" stroke="#E5E7EB" stroke-width="0.8"/>
                            <!-- Center fold line -->
                            <line x1="12" y1="2" x2="12" y2="16" stroke="#D1D5DB" stroke-width="0.6"/>
                            <!-- Wing fold lines -->
                            <line x1="12" y1="2" x2="4" y2="20" stroke="#D1D5DB" stroke-width="0.4"/>
                            <line x1="12" y1="2" x2="20" y2="20" stroke="#D1D5DB" stroke-width="0.4"/>
                            <!-- Inner wing details -->
                            <line x1="8" y1="11" x2="12" y2="8" stroke="#D1D5DB" stroke-width="0.4"/>
                            <line x1="16" y1="11" x2="12" y2="8" stroke="#D1D5DB" stroke-width="0.4"/>
                        </svg>
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                </div>
            </form>

            <!-- Status Message -->
            <div id="statusMessage" class="mt-4 p-4 rounded-lg hidden">
                <p id="statusText" class="text-center font-medium"></p>
            </div>
        </div>


    </div>

    <script>
        document.getElementById('patientForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            submitBtn.disabled = true;
            
            try {
                // Prepare form data
                const formData = new URLSearchParams();
                  formData.append('hn', document.getElementById('hn').value);
                  formData.append('fullname', document.getElementById('fullname').value);

                const day = document.getElementById('birthDay').value;
                const month = document.getElementById('birthMonth').value;
                const buddhistYear = document.getElementById('birthYear').value;
                const birthdate = `${day}/${month}/${buddhistYear}`;
                      formData.append('birthdate', birthdate);

                      formData.append('timestamp', new Date().toLocaleString('th-TH'));
                      formData.append('age', document.getElementById('age').value);
                      formData.append('doctor', document.getElementById('doctor').value);
                      formData.append('diagnosis', document.getElementById('diagnosis').value);
                      formData.append('consultFor', document.getElementById('consultFor').value);
                      formData.append('ward', document.getElementById('ward').value);

// ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
const response = await fetch('https://script.google.com/macros/s/AKfycbwidOJeqWDGs7RvT5cqGhE_bzlIRvlB6mtM9rOqtnmwolJ8f5dtv5yFmnI0Lj7jh3Liiw/exec', {
    method: 'POST',
    body: formData,
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
    }
});
                
                const result = await response.text();
                
                if (response.ok) {
                    // Show success message
                    showStatusMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
                    
                    // Reset form
                    this.reset();
                    
                    // Clear photo preview
                    if (document.getElementById('photoPreview')) {
                        document.getElementById('photoPreview').classList.add('hidden');
                    }
                    capturedPhoto = null;
                    
                    console.log('Data saved successfully:', result);
                } else {
                    throw new Error('Failed to save data');
                }
                
            } catch (error) {
                console.error('Error saving data:', error);
                showStatusMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
            } finally {
                // Reset button
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });
        
        function showStatusMessage(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            const statusText = document.getElementById('statusText');
            
            statusText.textContent = message;
            statusDiv.className = `mt-4 p-4 rounded-lg ${type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`;
            statusDiv.classList.remove('hidden');
            
            // Hide message after 3 seconds
            setTimeout(() => {
                statusDiv.classList.add('hidden');
            }, 3000);
        }
        
        // Add input validation and formatting
        document.getElementById('hn').addEventListener('input', function(e) {
            // Allow letters and numbers only, convert to uppercase
            this.value = this.value.replace(/[^A-Za-z0-9]/g, '').toUpperCase();
        });
        
        // Auto-resize textareas
        document.querySelectorAll('textarea').forEach(textarea => {
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = this.scrollHeight + 'px';
            });
        });
        
        // Populate day and year dropdowns
        function populateDateDropdowns() {
            // Populate days (1-31)
            const daySelect = document.getElementById('birthDay');
            for (let i = 1; i <= 31; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                daySelect.appendChild(option);
            }
            
            // Populate years (current Buddhist year - 120 to current Buddhist year)
            const yearSelect = document.getElementById('birthYear');
            const currentYear = new Date().getFullYear();
            const currentBuddhistYear = currentYear + 543;
            
            for (let i = currentBuddhistYear; i >= currentBuddhistYear - 120; i--) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                yearSelect.appendChild(option);
            }
        }
        
        // Age calculation for Buddhist calendar
        function updateAge() {
            const day = document.getElementById('birthDay').value;
            const month = document.getElementById('birthMonth').value;
            const buddhistYear = document.getElementById('birthYear').value;
            
            if (day && month && buddhistYear) {
                // Convert Buddhist year to Christian year
                const christianYear = parseInt(buddhistYear) - 543;
                const birthDate = new Date(christianYear, parseInt(month) - 1, parseInt(day));
                const today = new Date();
                
                const age = calculateAge(birthDate, today);
                document.getElementById('age').value = age;
            } else {
                document.getElementById('age').value = '';
            }
        }
        
        // Add event listeners for age calculation
        document.getElementById('birthDay').addEventListener('change', updateAge);
        document.getElementById('birthMonth').addEventListener('change', updateAge);
        document.getElementById('birthYear').addEventListener('change', updateAge);
        
        // Initialize dropdowns
        populateDateDropdowns();
        
        function calculateAge(birthDate, currentDate) {
            const diffTime = currentDate - birthDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            
            // If less than 30 days, show in days
            if (diffDays < 30) {
                return diffDays + ' ‡∏ß‡∏±‡∏ô';
            }
            
            // If less than 2 years, show in months
            const diffMonths = Math.floor(diffDays / 30.44); // Average days per month
            if (diffDays < 730) { // Less than 2 years
                return diffMonths + ' ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô';
            }
            
            // Otherwise show in years
            const years = Math.floor(diffDays / 365.25); // Account for leap years
            return years + ' ‡∏õ‡∏µ';
        }
        
        
        // File button
        document.getElementById('fileBtn').addEventListener('click', function() {
            document.getElementById('fileInput').click();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'968ca235820e50cb',t:'MTc1NDEyNzgzNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>